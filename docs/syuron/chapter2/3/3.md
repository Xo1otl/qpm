# カスケード第三高調波発生

cTHGは、二次の非線形光学効果を多段に利用することで、基本波から第三高調波を生成する現象である。
具体的には、第一段階として基本波 $\omega$ から第二高調波 $2\omega$ を生成するSHG過程（$\omega + \omega \to 2\omega$）と、第二段階として基本波と第二高調波から第三高調波 $3\omega$ を生成するSFG過程（$\omega + 2\omega \to 3\omega$）が同一のデバイス内で連続的に生じる。

<!-- 結合波方程式 -->

cTHGにおける基本波 ($A_1$)、第二高調波 ($A_2$)、第三高調波 ($A_3$) の複素振幅の空間的発展は、SHGとSFGの結合波方程式を連立させることで記述される。
前節までに定義した結合係数 $\kappa_{\text{SHG}}, \kappa_{\text{SFG}}$ および位相不整合量 $\Delta k_{\text{SHG}}, \Delta k_{\text{SFG}}$ を用いると、cTHGの結合波方程式は以下のようになる。

$$
\frac{d A_1}{dz} = i \left[ \kappa_{\text{SHG}} A_2 A_1^* e^{i\Delta k_{\text{SHG}} z} + \kappa_{\text{SFG}} A_3 A_2^* e^{i\Delta k_{\text{SFG}} z} \right]
$$

$$
\frac{d A_2}{dz} = i \left[ \kappa_{\text{SHG}} A_1^2 e^{-i\Delta k_{\text{SHG}} z} + 2 \kappa_{\text{SFG}} A_3 A_1^* e^{i\Delta k_{\text{SFG}} z} \right]
$$

$$
\frac{d A_3}{dz} = i \left[ 3 \kappa_{\text{SFG}} A_1 A_2 e^{-i\Delta k_{\text{SFG}} z} \right]
$$

ここで、式中の項はそれぞれSHG過程とSFG過程による寄与を表している。

<!-- 非励起減衰近似 -->

変換効率が数%以下と低く、基本波の枯渇を無視できる場合、非励起減衰近似を適用することができる。
基本波振幅を一定（$A_1(z) \approx A_1(0) = \text{const.}$）と仮定し、さらに第三高調波の振幅が微小であることから、$A_2$ の発展方程式におけるSFG項（$A_3$ に比例する項）を無視すると、方程式は以下のように簡略化される。

$$
\frac{d A_2}{dz} \approx i \kappa_{\text{SHG}}(z) A_1^2 e^{-i\Delta k_{\text{SHG}} z}
$$

$$
\frac{d A_3}{dz} = i 3 \kappa_{\text{SFG}}(z) A_1 A_2 e^{-i\Delta k_{\text{SFG}} z}
$$

これらを順次積分することで、出力端 $z=L$ における第三高調波振幅 $A_3(L)$ を導出できる。
まず、初期条件 $A_2(0)=0$ のもとで $A_2(z)$ を求めると、

$$
A_2(z) = i A_1^2 \int_0^{z} \kappa_{\text{SHG}}(z_1) e^{-i\Delta k_{\text{SHG}} z_1} dz_1
$$

となる。これは局所的なSHG振幅が、その地点までの結合係数のフーリエ変換的な積分で与えられることを示唆している。
次に、この $A_2(z)$ を $A_3$ の微分方程式に代入し、$z=0$ から $L$ まで積分する（$A_3(0)=0$）。

$$ A_3(L) = i 3 A_1 \int_0^L \kappa_{\text{SFG}}(z_2) \left( i A_1^2 \int_0^{z_2} \kappa_{\text{SHG}}(z_1) e^{-i\Delta k_{\text{SHG}} z_1} dz_1 \right) e^{-i\Delta k_{\text{SFG}} z_2} dz_2 $$

整理すると、以下の式が得られる。

$$
A_3(L) = -3 A_1^3 \int_0^L dz_2 \int_0^{z_2} dz_1 \kappa_{\text{SFG}}(z_2) \kappa_{\text{SHG}}(z_1) e^{-i(\Delta k_{\text{SHG}} z_1 + \Delta k_{\text{SFG}} z_2)}
$$

この二重積分項 $S$ を次のように定義する。

$$
S \equiv \int_0^L dz_2 \int_0^{z_2} dz_1 \kappa_{\text{SFG}}(z_2) \kappa_{\text{SHG}}(z_1) e^{-i(\Delta k_{\text{SHG}} z_1 + \Delta k_{\text{SFG}} z_2)}
$$

この $S$ がcTHG変換効率を決定する支配的な因子となる。
cTHGのような多段の非線形光学過程では、複数の位相整合条件（$\Delta k_{\text{SHG}}, \Delta k_{\text{SFG}}$）が関与するため、単純なフーリエ変換の関係では記述できない。

<!-- イジングモデルとの対応 -->

強誘電体結晶の分極反転デバイスにおいて、結合係数 $\kappa_{\text{SHG}}(z), \kappa_{\text{SFG}}(z)$ は材料固有の非線形定数に比例し、その符号は分極の向きによって決まる。
分極反転構造が長さ $L$ のデバイス全体で定義されており、これを $N$ 個の微小なドメイン（長さ $\Delta z = L/N$）に分割して考える。
$j$ 番目のドメイン（位置 $z_j$）における分極の向きをスピン変数 $s_j \in \{+1, -1\}$ で表すと、各結合係数は次のように記述できる。

$$
\kappa_{\text{SHG}}(z) = |\kappa_{\text{SHG}}| s(z), \quad \kappa_{\text{SFG}}(z) = |\kappa_{\text{SFG}}| s(z)
$$

ここで、$|\kappa_{\text{SHG}}|, |\kappa_{\text{SFG}}|$ は定数である。
この離散化モデルを $S$ の積分式に適用し、積分を和に置き換えると、

$$
S \approx \sum_{n=1}^{N} \Delta z \sum_{m=1}^{n} \Delta z |\kappa_{\text{SFG}}| s_n e^{-i\Delta k_{\text{SFG}} z_n} |\kappa_{\text{SHG}}| s_m e^{-i\Delta k_{\text{SHG}} z_m}
$$

となる。定数項をまとめ、$J_{nm} = |\kappa_{\text{SFG}}| |\kappa_{\text{SHG}}| (\Delta z)^2 e^{-i(\Delta k_{\text{SFG}} z_n + \Delta k_{\text{SHG}} z_m)}$ と置くと、

$$
S \approx \sum_{n=1}^{N} \sum_{m=1}^{n} J_{nm} s_n s_m
$$

と表せる。
この式は、相互作用係数 $J_{nm}$ を持つスピン系（イジングモデル）のハミルトニアン（エネルギー関数）と等価な形式（二次形式）をしている。
したがって、cTHGの変換効率最大化（$|S|$ の最大化）問題は、相互作用行列 $J$ を持つ一般化イジングモデルの基底状態（あるいは最大エネルギー状態）探索問題に帰着することができる。
この問題はNP困難であることが知られており、最適なドメイン構造を効率的に見つけ出すアルゴリズムが存在しないことを意味する。
また、特定の構造が最良であるかどうかを判定することも同様に困難である。
そして、近年では量子アニーリングなどの手法が、この種の問題に対して古典コンピュータより効率的に探索を行うことができるアプローチとして研究されている。
