## 数理最適化

所望の光学特性を持つQPMデバイスの設計は、評価関数（変換効率や帯域幅など）を最大化する分極反転構造を決定する逆問題である。この問題は、探索空間の捉え方によって「離散最適化問題」または「連続最適化問題」のいずれかに帰着させることができる。
本研究では、大域的探索を得意とする確率的手法であるシミュレーテッド・アニーリング（Simulated Annealing: SA）と、局所探索において高速な収束性を持つ決定論的手法であるL-BFGS（Limited-memory Broyden–Fletcher–Goldfarb–Shanno）法の2つの手法を採用した。

### 2.4.1 シミュレーテッド・アニーリング (Simulated Annealing)

SAは、固体の焼きなまし過程における結晶成長を模した確率的探索アルゴリズムである。局所解（Local Minima）へのトラップを回避し、大域的最適解（Global Optimum）を探索することに適している。

探索プロセスでは、現在の解$x$に対し近傍解$x'$をランダムに生成し、評価関数の変化量$\Delta E = E(x') - E(x)$を計算する。改善方向への遷移（最小化問題において$\Delta E < 0$）は無条件で受諾されるが、改悪方向への遷移であっても、仮想的な温度パラメータ$T$に依存した以下の確率$P$で受諾される（メトロポリス法）。

$$
P = \exp\left( -\frac{\Delta E}{T} \right)
$$

探索初期には$T$を大きく設定して広い解空間を探索させ、徐々に$T$を低下させることで、最終的に最適解近傍へと収束させる。

QPMデバイス設計において、SA法は**離散的な組合せ最適化問題**として適用される。具体的には、結晶を微小なセグメントに分割し、各セグメントの自発分極の向き（符号：$+1$ または $-1$）を設計変数とする。探索における近傍解の生成は、ランダムに選択されたセグメントの符号を反転（フリップ）させることで行われる。この手法は、ドメイン境界の位置をグリッド上に制約するものの、構造のトポロジー（分極の配置パターン）を大域的に探索することが可能である。

### 2.4.2 準ニュートン法 (L-BFGS)

L-BFGS法は、非線形最適化問題における準ニュートン法の一種であり、目的関数の勾配情報（一階微分）を用いて決定論的に解を探索する手法である。本来のニュートン法ではヘッセ行列（二階微分）の逆行列を必要とするが、L-BFGSでは直前の数ステップの勾配情報の履歴からこれを近似的に構成することで、計算コストとメモリ使用量を大幅に削減している。

本手法は、初期値が含まれる「引力圏（basin of attraction）」内の極値へ向かって高速かつ高精度に収束する特性を持つ。

QPMデバイス設計において、L-BFGS法は**連続変数の最適化問題**として適用される。ここでは、分極反転構造を構成する各ドメインの「幅（長さ）」そのものを連続的な設計変数として扱う。全てのドメイン幅を変数とした多次元空間において、評価関数の勾配方向へ構造を更新することで、物理的に最適なドメイン長分布を探索する。SA法とは異なり、グリッドの制約を受けないため、任意のドメイン幅を持つ構造の設計が可能である。

### 2.4.3 探索手法の比較

本研究で用いた2つの手法は、QPM構造の探索において対照的な性質を持つ。表2.1に両手法の比較を示す。

| 特徴 | シミュレーテッド・アニーリング (SA) | 準ニュートン法 (L-BFGS) |
| :--- | :--- | :--- |
| **数学的定式化** | 離散最適化（組合せ最適化） | 連続最適化（非線形最適化） |
| **設計変数** | 分極符号 ($\pm 1$) | ドメイン幅 ($w_i \in \mathbb{R}$) |
| **探索操作** | 符号の反転 (Flip) | ドメイン幅の伸縮 |
| **探索の性質** | 確率的・大域的 | 決定論的・局所的 |

**表 2.1 本研究における最適化手法の比較**