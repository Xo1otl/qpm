## 数理最適化

所望の光学特性を持つQPMデバイスの設計は、評価関数（変換効率や帯域幅など）を最大化する分極反転構造を決定する逆問題である。この問題は、探索空間の捉え方によって「離散最適化問題」または「連続最適化問題」のいずれかに帰着させることができる。
本研究では、目的関数の形状が未知である、あるいは勾配情報の取得が困難な場合にも適用可能な大域的最適化手法であるベイズ最適化（Bayesian Optimization: BO）と、局所探索において高速な収束性を持つ決定論的手法であるL-BFGS（Limited-memory Broyden–Fletcher–Goldfarb–Shanno）法の2つの手法を用いているため、その二つについて概説する。

### 2.4.1 ベイズ最適化 (Bayesian Optimization)

ベイズ最適化は、未知の目的関数（ブラックボックス関数）をガウス過程回帰（Gaussian Process Regression）を用いて確率モデルとして近似し、そのモデルに基づいて次に探索すべき点を決定する大域的最適化手法である。

探索プロセスでは、これまでの観測データから目的関数の事後分布（平均と分散）を推定する。この事後分布に基づき、獲得関数（Acquisition Function）と呼ばれる評価指標を最大化する点を次の探索点として選択する。獲得関数は、現在の推定最適解を超える可能性が高い領域（活用：Exploitation）と、不確実性が高く情報の少ない領域（探索：Exploration）のバランスを考慮して設計されており、これにより効率的な大域的探索が可能となる。代表的な獲得関数として、期待改善量（Expected Improvement: EI）や信頼区間上限（Upper Confidence Bound: UCB）などが知られている。

### 2.4.2 準ニュートン法 (L-BFGS)

L-BFGS法は、非線形最適化問題における準ニュートン法の一種であり、目的関数の勾配情報（一階微分）を用いて決定論的に解を探索する手法である。本来のニュートン法ではヘッセ行列（二階微分）の逆行列を必要とするが、L-BFGSでは直前の数ステップの勾配情報の履歴からこれを近似的に構成することで、計算コストとメモリ使用量を大幅に削減している。

本手法は、初期値が含まれる「引力圏（basin of attraction）」内の極値へ向かって高速かつ高精度に収束する特性を持つ。

### 2.4.3 探索手法の比較

表2.1に両手法の比較を示す。

| 特徴 | ベイズ最適化 (BO) | 準ニュートン法 (L-BFGS) |
| :--- | :--- | :--- |
| **数学的定式化** | ブラックボックス最適化 | 連続最適化（非線形最適化） |
| **設計変数** | ハイパーパラメータ（ターゲット幅・強度） | ドメイン幅 ($w_i \in \mathbb{R}$) |
| **探索操作** | 獲得関数の最大化 | ドメイン幅の伸縮 |
| **探索の性質** | 確率的・大域的 | 決定論的・局所的 |

**表 2.1 本研究における最適化手法の比較**
