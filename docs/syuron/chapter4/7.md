# 4.7 パルス伝搬解析の高速化

## 4.7.1 緒言
非線形光学におけるパルス伝搬解析では、一般的にスプリットステップ・フーリエ法 (Split-Step Fourier Method, SSFM) が用いられる。本研究で扱うSHGにおける$A_1$と$A_2$の結合波方程式は以下のように記述される。

$$
\frac{\partial A_1}{\partial z} = \underbrace{\left( -\frac{1}{v_{g1}} \frac{\partial}{\partial t} - \frac{i \beta_{2,1}}{2} \frac{\partial^2}{\partial t^2} \right) A_1}_{\hat{D}_1 A_1} + i \kappa^* A_2 A_1^* e^{+i \Delta k z}
$$

$$
\frac{\partial A_2}{\partial z} = \underbrace{\left( -\frac{1}{v_{g2}} \frac{\partial}{\partial t} - \frac{i \beta_{2,2}}{2} \frac{\partial^2}{\partial t^2} \right) A_2}_{\hat{D}_2 A_2} + i \kappa A_1^2 e^{-i \Delta k z}
$$

ここで、$\hat{D}_j$ は分散や群速度を記述する線形演算子、$\kappa$ は非線形相互作用項である。SSFMでは、これらを微小なステップ幅 $h$ ごとに交互に適用することで解を求める。本手法では、線形ステップ($h/2$) $\to$ 非線形ステップ($h$) $\to$ 線形ステップ($h/2$) の順序で計算を行う対称分割（Symmetric Splitting Algorithm）を採用する。

## 4.7.2 Step I: Linear Half-Step ($h/2$)
まず、ステップ前半の線形演算を行う。分散と群速度遅延を周波数領域で計算する。

$$
\tilde{A}_j(z_n, \omega) = \mathcal{F}[A_j(z_n, t)]
$$

$$
\tilde{A}_j^{(1)}(\omega) = \tilde{A}_j(z_n, \omega) \exp\left[ i \left( \frac{\omega}{v_{gj}} + \frac{\beta_{2,j}\omega^2}{2} \right) \frac{h}{2} \right]
$$

$$
A_j^{(1)}(t) = \mathcal{F}^{-1}[\tilde{A}_j^{(1)}(\omega)]
$$

## 4.7.3 Step II: Nonlinear Step ($h$)
次に、非線形ステップの計算を行う。非線形損失を無視し、ステップ幅 $h$ 内で場の振幅が一定であると仮定する（Euler approximation）。

**有効結合係数**
ステップ幅 $h$ における非線形相互作用への寄与を、以下の有効結合係数 $\tilde{\kappa}(\Delta k)$ として定義する。

$$
\tilde{\kappa}(\Delta k) \equiv \int_{z_n}^{z_{n+1}} \kappa(z) e^{i \Delta k z} dz
$$

**更新式**
基本波 ($A_1$) と第 2 高調波 ($A_2$) は、時間領域で以下のように更新される。ここで、$A_j^{(1)}$ は Step I の出力である。

$$
A_1^{(2)}(t) = A_1^{(1)}(t) + i A_2^{(1)}(t) (A_1^{(1)}(t))^* \tilde{\kappa}(+\Delta k)
$$

$$
A_2^{(2)}(t) = A_2^{(1)}(t) + i (A_1^{(1)}(t))^2 \tilde{\kappa}(-\Delta k)
$$

これにより、非線形相互作用後の場 $A_j^{(2)}$ が得られる。

## 4.7.4 Step III: Linear Half-Step ($h/2$)
最後に、ステップ後半の線形演算を行う。

$$
\tilde{A}_j^{(2)}(\omega) = \mathcal{F}[A_j^{(2)}(t)]
$$

$$
\tilde{A}_j(z_{n+1}, \omega) = \tilde{A}_j^{(2)}(\omega) \exp\left[ i \left( \frac{\omega}{v_{gj}} + \frac{\beta_{2,j}\omega^2}{2} \right) \frac{h}{2} \right]
$$

$$
A_j(z_{n+1}, t) = \mathcal{F}^{-1}[\tilde{A}_j(z_{n+1}, \omega)]
$$

## 4.7.5 収束条件と制約
本手法の有効性は、以下の収束条件と制約によって制限される。

**Walk-off**
パルス間の群速度不整合 (GVM) による制約である。

$$
h \ll L_{walk} = \frac{\tau_p}{|v_{g1}^{-1} - v_{g2}^{-1}|}
$$

**Dispersion**
群速度分散 (GVD) による制約である。

$$
h \ll L_{disp} = \frac{\tau_p^2}{|\beta_2|}
$$

**QPM Period**
本手法では、分極反転周期 $\Lambda$ よりも大きなステップ幅 $h$ を許容する。

$$
h > \Lambda
$$

## 4.7.6 実現可能性と最適化への応用
これにより、パルス励起下でのQPM構造の勾配ベース最適化への道が開かれる。
