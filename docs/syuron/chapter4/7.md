# 4.7 パルス伝搬解析の高速化

## 4.7.1 緒言
非線形光学におけるパルス伝搬解析では、一般的にスプリットステップ・フーリエ法 (Split-Step Fourier Method, SSFM) が用いられる。SSFMでは、線形演算子（分散・Walk-off）と非線形演算子（非線形相互作用）を微小なステップ幅 $h$ ごとに交互に適用することで解を求める。

従来のQPMデバイスの解析においては、非線形ステップの積分に4次のルンゲ・クッタ相互作用描像法 (Runge-Kutta 4th-order Interaction Picture, RK4IP) が広く採用されている。しかし、RK4IPを用いてQPM構造を正確にシミュレーションするためには、分極反転周期 $\Lambda$ (通常数 $\mu$m オーダー) よりも十分に小さいステップ幅 $h \ll \Lambda$ でサンプリングを行う必要がある。デバイス長 $L$ が数 cm に及ぶ場合、ステップ数 $N = L/h$ は膨大な数 ($10^4 \sim 10^5$) となり、各ステップでFFTを計算する必要があるため、計算コストは極めて高くなる。

特に、広帯域化や高効率化のためにQPM構造の最適化を行う場合、この計算コストは致命的となる。連続波 (CW) 近似の下では勾配法を用いた高速な最適化が可能であるが、パルス伝搬を考慮した最適化は、計算時間の制約から困難であった。

本節では、第 4.3 節で導入した「有効結合係数」の概念をスプリットステップ・フーリエ法 (SSFM) に拡張し、パルス伝搬解析を数桁 (orders of magnitude) 高速化する新たな手法を提案する。

## 4.7.2 提案手法：有効結合係数を用いた積分スキーム
提案手法の核心は、非線形ステップにおける結合係数 $\kappa(z)$ の取り扱いにある。第 4.3 節で述べたように、CW 近似における結合波方程式の数値解法として、激しく振動する $\kappa(z)$ を積分して滑らかな「有効結合係数」として扱う手法が有効であった。本手法では、この考え方を SSFM の非線形ステップの積分に適用する。

### 有効結合係数と更新式
ステップ幅 $h$ における非線形相互作用への寄与を、以下の有効結合係数 $\tilde{\kappa}(\Delta k)$ として定義する。

$$
\tilde{\kappa}(\Delta k) \equiv \int_{z}^{z+h} \kappa(z') e^{i \Delta k z'} dz'
$$

これを用いた更新式（SHGの場合）は以下の通りである。

$$
A_1^{(2)} = A_1^{(1)} + i A_2^{(1)} (A_1^{(1)})^* \tilde{\kappa}(-\Delta k)
$$
$$
A_2^{(2)} = A_2^{(1)} + i (A_1^{(1)})^2 \tilde{\kappa}(+\Delta k)
$$

このスキームでは、結合係数の高速な振動成分が積分によって平滑化されるため、数値積分の精度を分極反転周期 $\Lambda$ に依存せずに保つことができる。その結果、従来法 (RK4IP) で必須であった $h \ll \Lambda$ という制約から解放され、$h \gg \Lambda$ となるような大きなステップ幅を採用可能となる。これにより、「周期性を無視したサンプリング (sampling that ignores periodicity)」が実現し、計算時間を数桁 (orders of magnitude) 短縮できる。

## 4.7.3 実現可能性と最適化への応用
本手法における計算チェーン（computational chain）は、CW近似における勾配法と同様の構造を持つ。つまり、各計算ステップが微分可能な演算で構成されているため、誤差逆伝播法（Backpropagation）や随伴変数法（Adjoint Method）を適用することが可能となる。

これにより、従来は計算コストの観点から非現実的であった、パルス励起下でのQPM構造の大規模な勾配ベース最適化が実現可能となる。本手法の実装は現在進行中であるが、その理論的枠組みは確立されており、QPMデバイスの設計・解析にパラダイムシフトをもたらす可能性を秘めている。
