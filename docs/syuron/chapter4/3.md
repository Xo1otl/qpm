# 数値計算の速度と精度の評価

本手法の計算オーダーはUPAの解析解と同じくO(N)である。次に、実際に計算した結果を用いて速度と精度の評価を行う。

先行研究で述べられていた10mmのSHGの一定周期構造に続けてSFGの一定周期構造を追加したタンデム構造を考える。長さは第三高調波出力が得られる7.5mmとし、$\kappa_{\mathrm{SFG}}=2\kappa_{\mathrm{SHG}}$とし、励起光パワーを10Wとする。励起光パワーを10Wとする。UPAとRK法(SciPy)とSuper Step法(ブロックサイズ31)のそれぞれを用いて第三高調波の出力振幅を計算したところ、結果は以下の表のようになった。

| 計算手法 | 計算時間 [s] | $\|a_3\|$ の値 |
| :--- | :--- | :--- |
| Super Step 法 | 0.005740 | 1.729416 |
| NPDA 法 | 0.002207 | 3.201053 |
| SciPy ODE (RK45) | 0.913495 | 1.682233 |
| SciPy ODE (DOP853/GT) | 43.175107 | 1.707915 |

<!-- 図 -->

計算時間はUPAの3倍程度だが、RKよりも100倍以上高速である。出力される第三高調波のパワーは約3W(振幅の2乗)と見積もられる。このような高効率な変換では、UPAの出力は誤差が大きいことに留意されたい。

次に精度を比較するために、デバイス長を長くとり、SHG部を10mm,SFG部を30mmとした。
DOP853とRK45とSuper Step法(ブロックサイズ31)を用いて計算したところ、振幅のz依存性と計算時間は以下のようになった。

<!-- 図 -->

Super Step法はRK45に比べて100倍程度高速でありながら、よりDOP853に近い結果となっている。これにより、実用的な時間で数理最適化における反復計算が可能となる。
