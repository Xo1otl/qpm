### 微分方程式

複素振幅を $B_j(z)$ とすると、結合波方程式は以下で与えられます。ここで、$k$ は結合係数、$z$ は伝搬距離です。

$$
\begin{aligned}
\frac{dB_1}{dz} &= i k B_2^* B_3 \\
\frac{dB_2}{dz} &= i (2k) B_1^* B_3 \\
\frac{dB_3}{dz} &= i (3k) B_1 B_2
\end{aligned}
$$

### 解析解

各波の強度 $I_j(z) = |B_j(z)|^2$ は、ヤコビの楕円関数を用いて解析的に記述できます。

$I_1(z)$ の解は以下の通りです。

$$I_1(z) = u_2 + (u_1 - u_2) \text{cn}^2(\Omega (z - z_0), m)$$

ここで、$\text{cn}$ はヤコビの楕円関数の1つです。$I_2(z)$ と $I_3(z)$ は、Manley-Roweの不変量 $M_1, M_2$ を用いて $I_1(z)$ から直接計算されます。

$$
\begin{aligned}
I_2(z) &= 2 I_1(z) - M_1 \\
I_3(z) &= -3 I_1(z) + M_2
\end{aligned}
$$

解のパラメータは以下のように定義されます。

* **不変量**:
    $M_1 = 2 I_1(0) - I_2(0)$
    $M_2 = 3 I_1(0) + I_3(0)$

* **多項式の根**:
    $u_1, u_2, u_3$ は、以下の3次多項式の3つの実根です ($u_1 > u_2 > u_3$)。
    $$-24k^2 u^3 + 4k^2(2M_2 + 3M_1)u^2 - 4k^2 M_1 M_2 u - K_{sfg}^2 = 0$$
    ここで、$K_{sfg} = 2k\sqrt{I_1(0)I_2(0)I_3(0)} \cos(\phi_3(0) - \phi_2(0) - \phi_1(0))$ であり、$\phi_j(0)$ は初期位相です。

* **楕円パラメータ**:
    * 角周波数: $\Omega = k \sqrt{6(u_1 - u_3)}$
    * modulus: $m = \frac{u_1 - u_2}{u_1 - u_3}$
    * 位相オフセット: $z_0 = -\frac{1}{\Omega} F\left(\arcsin\sqrt{\frac{u_1 - I_1(0)}{u_1 - u_2}}, m\right)$
      ここで、$F(\phi, m)$ は第一種不完全楕円積分です。
